<!DOCTYPE html>
<html>

<head>
    <title>Page Title</title>
</head>
<body>
    <header>
        <h1>Square Seeker</h1>
    </header>
    <main>
        <canvas></canvas>
    </main>
    <footer>
        <button id="startButton">Start</button>
        <section>Time Left: <span id="timer">0</span> seconds  </section>
        <section>Score: <span id="score">0</span></section>
    </footer>

    <script>
        const canvas = document.querySelector('canvas')
        canvas.width = 300
        canvas.height = 300
        const ctx= canvas.getContext('2d')

        let score = 0

        let player_x = 20
        let player_y = 20
        let base_x = Math.floor(Math.random() * 250)
        let base_y = Math.floor(Math.random() * 250)
        let gameStarted = false; // Flag to track if the game has started

        function step(){
            if(gameStarted){
                ctx.clearRect(0, 0, 300, 300)
                ctx.fillStyle= 'red'
                ctx.fillRect(player_x, player_y, 10, 10)
                ctx.strokeRect(base_x, base_y, 50, 50)

                if(player_x+10 > base_x && player_y+10 > base_y+10 && player_x < base_x + 50 && player_y < base_y + 50){
                    score+=5
                    base_x = Math.floor(Math.random() * 250)
                    base_y = Math.floor(Math.random() * 250)
                }

                const scoreElement = document.getElementById('score');
                scoreElement.textContent = score;

                requestAnimationFrame(step)
                }

            }

        requestAnimationFrame(step)


        function handleInput(event){
            const key = event.key
            if( key == 'a'){
                player_x -= 10
            }
            else if( key == 'w'){
                player_y -= 10
            } else if ( key == 'd'){
                player_x += 10
            } else if ( key == 's'){
                player_y += 10
            }
        }

        function startGame() {
        gameStarted = true;
        requestAnimationFrame(step);
        }

        let timer = 0;
        let intervalId; // Variable to store the setInterval ID

        function startGame() {
            if (!gameStarted) {
            gameStarted = true;
            timer = 60; // Set the initial timer value (in seconds)
            updateTimerDisplay(); // Display the initial timer value
            intervalId = setInterval(updateTimer, 1000); // Start the timer
            startButton.disabled = true; // Disable the "Start" button during the game
            requestAnimationFrame(step);
        }
        }

        function updateTimer() {
        if (gameStarted) {
            timer--; // Decrement the timer by 1 second
            updateTimerDisplay(); // Update the displayed timer value

            if (timer <= 0) {
                endGame(); // Call the endGame function when the timer reaches 0 seconds
            }
        }
    }

    function updateTimerDisplay() {
        const timerElement = document.getElementById('timer');
        timerElement.textContent = timer;
    }

    function endGame() {
        gameStarted = false;
        clearInterval(intervalId); // Stop the timer interval
        startButton.disabled = false; // Enable the "Start" button after the game is over
        alert('Game Over! Your final score is: ' + score); // Display a game over message with the final score
    }

        function endGame() {
            gameStarted = false;
            clearInterval(intervalId); // Stop the timer interval
            // You can add game over logic here, e.g., display a message or reset the game.
        }

        document.addEventListener('keypress', handleInput)
        const startButton = document.getElementById('startButton');
        startButton.addEventListener('click', startGame);
    </script>

    <style>
        canvas{
            border: 1px solid black;
        }
    </style>
</body>

</html>